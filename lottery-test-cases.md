# 秘境抽奖系统测试用例

## 1. 功能测试用例

### 1.1 用户抽奖功能测试

#### 测试用例 1.1.1: 正常抽奖流程
**测试目标**: 验证用户正常抽奖流程
**前置条件**: 
- 用户已登录
- 用户等级为炼气境(1级)
- 今日抽奖次数未用完

**测试步骤**:
1. 用户访问抽奖页面
2. 选择对应等级的转盘
3. 点击抽奖按钮
4. 观察转盘动画效果
5. 查看抽奖结果

**预期结果**:
- 转盘正常旋转并停止在某个位置
- 显示获得的奖品信息
- 奖励自动发放到用户账户
- 剩余抽奖次数减1
- 保底计数器+1

#### 测试用例 1.1.2: 抽奖次数限制
**测试目标**: 验证每日抽奖次数限制
**前置条件**: 
- 用户今日抽奖次数已达上限

**测试步骤**:
1. 用户尝试进行抽奖
2. 系统检查剩余次数

**预期结果**:
- 系统提示"今日抽奖次数已用完"
- 抽奖按钮置灰不可点击
- 显示次日重置时间

#### 测试用例 1.1.3: 等级权限验证
**测试目标**: 验证用户等级权限控制
**前置条件**: 
- 用户等级为炼气境(1级)
- 尝试使用高等级转盘

**测试步骤**:
1. 用户尝试访问大乘境转盘
2. 系统验证用户等级

**预期结果**:
- 系统提示"等级不足，无法使用此转盘"
- 高等级转盘显示为锁定状态
- 提示升级要求

### 1.2 保底机制测试

#### 测试用例 1.2.1: 保底触发
**测试目标**: 验证保底机制正常触发
**前置条件**: 
- 用户保底计数器达到阈值-1
- 转盘配置保底阈值为10次

**测试步骤**:
1. 用户进行第10次抽奖
2. 系统检查保底状态
3. 强制给予保底奖品

**预期结果**:
- 必定获得配置的保底奖品
- 保底计数器重置为0
- 抽奖记录标记为保底触发
- 显示保底触发特效

#### 测试用例 1.2.2: 保底计数器重置
**测试目标**: 验证保底计数器正确重置
**前置条件**: 
- 用户在保底前获得稀有奖品

**测试步骤**:
1. 用户抽中epic或legendary奖品
2. 系统检查是否重置保底

**预期结果**:
- 保底计数器重置为0
- 重新开始保底计数

### 1.3 奖励发放测试

#### 测试用例 1.3.1: 兑换码奖励发放
**测试目标**: 验证兑换码奖励正确发放
**前置条件**: 
- 系统中有可用的对应金额兑换码
- 用户抽中兑换码奖品

**测试步骤**:
1. 用户抽中5元兑换码
2. 系统查找可用兑换码
3. 分配兑换码给用户

**预期结果**:
- 用户获得一个5元兑换码
- 兑换码状态更新为已分配
- 用户可在个人中心查看兑换码

#### 测试用例 1.3.2: 经验值奖励发放
**测试目标**: 验证经验值奖励正确发放
**前置条件**: 
- 用户当前经验值为100
- 抽中50点经验奖励

**测试步骤**:
1. 用户抽中经验值奖品
2. 系统发放经验奖励
3. 检查用户经验值变化

**预期结果**:
- 用户经验值增加到150
- 触发等级升级检查
- 记录经验获得日志

#### 测试用例 1.3.3: 签到效果发放
**测试目标**: 验证签到增益效果正确应用
**前置条件**: 
- 用户抽中"签到双倍"效果
- 效果持续24小时

**测试步骤**:
1. 用户抽中签到增益
2. 系统应用效果到用户
3. 用户进行签到测试

**预期结果**:
- 用户活动效果表中新增记录
- 签到时经验获得翻倍
- 效果在24小时后自动失效

### 1.4 惩罚机制测试

#### 测试用例 1.4.1: 经验值惩罚
**测试目标**: 验证经验值惩罚正确执行
**前置条件**: 
- 用户当前经验值为100
- 抽中-30经验惩罚

**测试步骤**:
1. 用户抽中惩罚奖品
2. 系统扣除用户经验
3. 检查经验值变化

**预期结果**:
- 用户经验值减少到70
- 不会导致等级下降到负数
- 记录惩罚执行日志

#### 测试用例 1.4.2: 签到减益效果
**测试目标**: 验证签到减益效果正确应用
**前置条件**: 
- 用户抽中"签到减半"效果

**测试步骤**:
1. 用户抽中减益效果
2. 系统应用负面效果
3. 用户进行签到测试

**预期结果**:
- 签到经验获得减半
- 效果在指定时间后失效
- 用户可查看当前负面效果

## 2. 管理员功能测试

### 2.1 奖品池管理测试

#### 测试用例 2.1.1: 创建奖品
**测试目标**: 验证管理员可以创建新奖品
**前置条件**: 
- 管理员已登录
- 具有奖品管理权限

**测试步骤**:
1. 访问奖品池管理页面
2. 点击"创建奖品"按钮
3. 填写奖品信息
4. 提交创建请求

**预期结果**:
- 奖品成功创建并显示在列表中
- 奖品信息正确保存
- 可在转盘配置中选择该奖品

#### 测试用例 2.1.2: 编辑奖品
**测试目标**: 验证管理员可以编辑现有奖品
**前置条件**: 
- 存在可编辑的奖品

**测试步骤**:
1. 选择要编辑的奖品
2. 修改奖品属性
3. 保存修改

**预期结果**:
- 奖品信息成功更新
- 已配置的转盘自动更新
- 记录修改操作日志

### 2.2 转盘配置测试

#### 测试用例 2.2.1: 创建转盘配置
**测试目标**: 验证管理员可以创建新转盘
**前置条件**: 
- 奖品池中有可用奖品

**测试步骤**:
1. 创建新转盘配置
2. 设置基础参数
3. 添加转盘物品
4. 设置概率分配

**预期结果**:
- 转盘配置成功创建
- 概率总和等于100%
- 用户可以使用新转盘

#### 测试用例 2.2.2: 概率验证
**测试目标**: 验证转盘概率配置正确性
**前置条件**: 
- 转盘中有多个不同概率的奖品

**测试步骤**:
1. 配置转盘物品概率
2. 系统验证概率总和
3. 提交配置

**预期结果**:
- 概率总和必须等于100%
- 不符合要求时显示错误提示
- 保存成功后概率生效

## 3. 性能测试用例

### 3.1 并发抽奖测试
**测试目标**: 验证系统在高并发下的稳定性
**测试条件**: 100个用户同时进行抽奖
**预期结果**: 
- 所有抽奖请求正确处理
- 数据一致性保持
- 响应时间在可接受范围内

### 3.2 大数据量测试
**测试目标**: 验证系统处理大量历史数据的能力
**测试条件**: 100万条抽奖记录
**预期结果**:
- 查询响应时间<2秒
- 分页功能正常
- 统计计算准确

## 4. 安全测试用例

### 4.1 权限验证测试
**测试目标**: 验证用户权限控制
**测试步骤**:
1. 普通用户尝试访问管理功能
2. 低等级用户尝试使用高等级转盘
3. 未登录用户尝试抽奖

**预期结果**: 所有越权操作被正确拦截

### 4.2 数据完整性测试
**测试目标**: 验证数据操作的完整性
**测试步骤**:
1. 模拟网络中断场景
2. 模拟数据库异常
3. 验证事务回滚

**预期结果**: 数据保持一致性，无脏数据产生

## 5. 兼容性测试用例

### 5.1 浏览器兼容性
**测试目标**: 验证不同浏览器的兼容性
**测试范围**: Chrome, Firefox, Safari, Edge
**预期结果**: 所有功能在各浏览器中正常工作

### 5.2 移动端适配
**测试目标**: 验证移动端用户体验
**测试设备**: iOS, Android设备
**预期结果**: 界面适配良好，操作流畅
